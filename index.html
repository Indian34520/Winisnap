<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>MiniSnap — Kamera</title>
<style>
  :root{--accent:#2b6;--blue:#59f}
  body{font-family:system-ui,Arial;margin:0;background:#f4f6fb;color:#122}
  header{display:flex;justify-content:space-between;align-items:center;padding:12px 18px;background:white;box-shadow:0 1px 4px rgba(0,0,0,.06)}
  header h1{margin:0;font-size:18px}
  header .right{display:flex;gap:10px;align-items:center}
  header button{padding:8px 10px;border-radius:8px;border:none;background:var(--blue);color:white;cursor:pointer}
  main{display:flex;gap:18px;padding:18px}
  #left,#right{background:white;padding:12px;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,.03)}
  #left{flex:1;min-width:320px}#right{flex:1;min-width:320px;max-width:520px}
  video,canvas{width:100%;border-radius:10px;background:#000;display:block}
  .controls{margin-top:10px;display:flex;gap:8px;align-items:center;flex-wrap:wrap}
  select,input[type=text]{padding:8px;border-radius:8px;border:1px solid #ddd}
  button.btn{padding:8px 12px;border-radius:8px;border:none;cursor:pointer;background:var(--accent);color:#013;font-weight:700}
  .snap-item{display:flex;gap:10px;align-items:center;border:1px solid #eee;padding:8px;border-radius:8px;margin-bottom:8px;background:#fff}
  .thumb{width:80px;height:60px;object-fit:cover;border-radius:6px}
  .open{padding:6px 8px;background:var(--blue);color:white;border-radius:6px;cursor:pointer;border:none}
  #sendModal,#viewer,#replyModal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.6);z-index:40}
  .modalCard{background:white;padding:14px;border-radius:12px;width:90%;max-width:520px}
  #sendList{max-height:240px;overflow:auto;margin:8px 0}
  .recipient{display:flex;align-items:center;gap:8px;padding:6px 4px}
  #viewer img{max-width:90vw;max-height:70vh;border-radius:10px;display:block}
  #timer{color:white;font-weight:700;margin-top:10px;text-align:center;font-size:20px}
  .small{font-size:13px;color:#666}
</style>
</head>
<body onload="initPage()">
<header>
  <div><h1>MiniSnap</h1><div class="small" id="welcome">👋 Willkommen</div></div>
  <div class="right">
    <span id="userLabel" style="font-weight:700"></span>
    <button onclick="logoutUser()">Abmelden</button>
  </div>
</header>
<main>
  <section id="left">
    <h2>📸 Kamera</h2>
    <video id="cam" autoplay playsinline></video>
    <div class="controls">
      <select id="filterSelect">
        <option value="none">Kein Filter</option>
        <option value="red">🔴 Rot</option>
        <option value="blue">🔵 Blau</option>
        <option value="yellow">🟡 Gelb</option>
        <option value="pink">🌸 Pink</option>
        <option value="green">🌿 Grün</option>
        <option value="blackwhite">⚫ S/W</option>
        <option value="sepia">☕ Sepia</option>
        <option value="invert">🌀 Negativ</option>
        <option value="blur">🌫️ Weichzeichnen</option>
        <option value="sunglasses">🕶️ Sonnenbrille</option>
        <option value="text">📝 Text</option>
      </select>
      <input id="textInput" type="text" placeholder="Text für Text-Filter (falls gewählt)" style="display:none;" />
      <button id="snapBtn" class="btn">Foto machen</button>
    </div>
    <canvas id="photo" style="display:none;"></canvas>
  </section>
  <section id="right">
    <h2>📥 Deine Inbox</h2>
    <div id="inbox" style="min-height:200px"></div>
    <p class="small">Snaps löschen sich beim Öffnen automatisch. Du kannst antworten.</p>
  </section>
</main>
<!-- Send Modal -->
<div id="sendModal"><div class="modalCard">
  <h3>Wähle Empfänger</h3>
  <div id="sendPreview" style="margin-bottom:8px;"></div>
  <div id="sendList"></div>
  <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:8px;">
    <button id="cancelSend" class="btn" style="background:#ddd">Abbrechen</button>
    <button id="confirmSend" class="btn">Senden</button>
  </div>
</div></div>
<!-- Viewer -->
<div id="viewer"><div style="text-align:center;">
  <img id="viewImg" alt="snap" />
  <div id="timer">3</div>
  <div style="margin-top:8px;display:flex;gap:8px;justify-content:center;">
    <button id="replyBtn" class="btn" style="background:#ffb74d;color:#150">Antworten</button>
    <button id="closeBtn" class="btn" style="background:#ddd">Schließen</button>
  </div>
</div></div>
<!-- Reply Modal -->
<div id="replyModal"><div class="modalCard">
  <h3>Antworten an <span id="replyToLabel"></span></h3>
  <video id="replyCam" autoplay playsinline style="width:100%;border-radius:8px;background:#000"></video>
  <div style="margin-top:8px;display:flex;gap:8px;justify-content:flex-end;">
    <button id="cancelReply" class="btn" style="background:#ddd">Abbrechen</button>
    <button id="sendReply" class="btn">Foto senden</button>
  </div>
</div></div>
<script src="script.js"></script>
</body>
</html>